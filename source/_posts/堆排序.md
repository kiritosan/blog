---
title: 堆排序
date: 2021-12-14 10:25:30
tags:
- 算法
---
```JavaScript
function heapSort(arr) {
    let n = arr.length;
    if (n <= 1) {
        return arr;
    }
    // build a heap 从后往前 从上到下
    for (let i = Math.floor(n/2); i >= 0; i--) {
        heapify(arr, i, n);
    }
    // sort
    // 循环来缩短堆的长度
    for (let i = 0; i < n; i++) {
        // 第一个和最后一个交换
        swap(arr, 0, n - 1 - i);
        // 只需heapify第一个元素 堆长度减一
        heapify(arr, 0, n - 2 - i);
    }
    return arr;
}

function swap(arr, a, b) {
    [arr[a], arr[b]] = [arr[b], arr[a]];
}

function heapify(arr, i, size) {
    let l = 2*i+1;
    let r = 2*i+2;
    let largest = i;
    if (l <= size && arr[l] > arr[i]) {
        largest = l;
    }
    if (r <= size && arr[r] > arr[i]) {
        largest = r;
    }
    if (largest !== i) {
        swap(arr, i, largest);
        heapify(arr, largest, size);
    }
}

let arr = [4,5,3,4,5]
heapSort(arr)
```